<script lang="ts">
	import TreemapChart from '$lib/components/Chart/TreemapChart.svelte';
	import { pageTitle } from '$lib/utils/stores';

	$pageTitle = 'Vulnerability Treemap';

	// Dummy data structure: domains -> severity -> status
	const dummyData = [
		{
			name: 'Infrastructure',
			id: 'infrastructure',
			children: [
				{
					name: 'Critical',
					id: 'critical',
					children: [
						{ name: 'Open', id: 'open-1', value: 5 },
						{ name: 'In Progress', id: 'in-progress-1', value: 3 },
						{ name: 'Resolved', id: 'resolved-1', value: 2 }
					]
				},
				{
					name: 'High',
					id: 'high',
					children: [
						{ name: 'Open', id: 'open-2', value: 8 },
						{ name: 'In Progress', id: 'in-progress-2', value: 12 },
						{ name: 'Resolved', id: 'resolved-2', value: 15 }
					]
				},
				{
					name: 'Medium',
					id: 'medium',
					children: [
						{ name: 'Open', id: 'open-3', value: 15 },
						{ name: 'In Progress', id: 'in-progress-3', value: 20 },
						{ name: 'Resolved', id: 'resolved-3', value: 25 }
					]
				},
				{
					name: 'Low',
					id: 'low',
					children: [
						{ name: 'Open', id: 'open-4', value: 10 },
						{ name: 'In Progress', id: 'in-progress-4', value: 8 },
						{ name: 'Resolved', id: 'resolved-4', value: 30 }
					]
				}
			]
		},
		{
			name: 'Applications',
			id: 'applications',
			children: [
				{
					name: 'Critical',
					id: 'critical-2',
					children: [
						{ name: 'Open', id: 'open-5', value: 3 },
						{ name: 'In Progress', id: 'in-progress-5', value: 2 },
						{ name: 'Resolved', id: 'resolved-5', value: 1 }
					]
				},
				{
					name: 'High',
					id: 'high-2',
					children: [
						{ name: 'Open', id: 'open-6', value: 6 },
						{ name: 'In Progress', id: 'in-progress-6', value: 10 },
						{ name: 'Resolved', id: 'resolved-6', value: 12 }
					]
				},
				{
					name: 'Medium',
					id: 'medium-2',
					children: [
						{ name: 'Open', id: 'open-7', value: 18 },
						{ name: 'In Progress', id: 'in-progress-7', value: 22 },
						{ name: 'Resolved', id: 'resolved-7', value: 28 }
					]
				},
				{
					name: 'Low',
					id: 'low-2',
					children: [
						{ name: 'Open', id: 'open-8', value: 12 },
						{ name: 'In Progress', id: 'in-progress-8', value: 15 },
						{ name: 'Resolved', id: 'resolved-8', value: 40 }
					]
				},
				{
					name: 'Info',
					id: 'info-1',
					children: [
						{ name: 'Open', id: 'open-9', value: 5 },
						{ name: 'In Progress', id: 'in-progress-9', value: 3 },
						{ name: 'Resolved', id: 'resolved-9', value: 20 }
					]
				}
			]
		},
		{
			name: 'Cloud Services',
			id: 'cloud',
			children: [
				{
					name: 'Critical',
					id: 'critical-3',
					children: [
						{ name: 'Open', id: 'open-10', value: 2 },
						{ name: 'In Progress', id: 'in-progress-10', value: 4 },
						{ name: 'Resolved', id: 'resolved-10', value: 3 }
					]
				},
				{
					name: 'High',
					id: 'high-3',
					children: [
						{ name: 'Open', id: 'open-11', value: 7 },
						{ name: 'In Progress', id: 'in-progress-11', value: 9 },
						{ name: 'Resolved', id: 'resolved-11', value: 14 }
					]
				},
				{
					name: 'Medium',
					id: 'medium-3',
					children: [
						{ name: 'Open', id: 'open-12', value: 12 },
						{ name: 'In Progress', id: 'in-progress-12', value: 16 },
						{ name: 'Resolved', id: 'resolved-12', value: 22 }
					]
				},
				{
					name: 'Low',
					id: 'low-3',
					children: [
						{ name: 'Open', id: 'open-13', value: 8 },
						{ name: 'In Progress', id: 'in-progress-13', value: 5 },
						{ name: 'Resolved', id: 'resolved-13', value: 25 }
					]
				},
				{
					name: 'Info',
					id: 'info-2',
					children: [
						{ name: 'Open', id: 'open-14', value: 10 },
						{ name: 'In Progress', id: 'in-progress-14', value: 8 },
						{ name: 'Resolved', id: 'resolved-14', value: 35 }
					]
				}
			]
		},
		{
			name: 'Network',
			id: 'network',
			children: [
				{
					name: 'High',
					id: 'high-4',
					children: [
						{ name: 'Open', id: 'open-15', value: 4 },
						{ name: 'In Progress', id: 'in-progress-15', value: 6 },
						{ name: 'Resolved', id: 'resolved-15', value: 8 }
					]
				},
				{
					name: 'Medium',
					id: 'medium-4',
					children: [
						{ name: 'Open', id: 'open-16', value: 9 },
						{ name: 'In Progress', id: 'in-progress-16', value: 11 },
						{ name: 'Resolved', id: 'resolved-16', value: 18 }
					]
				},
				{
					name: 'Low',
					id: 'low-4',
					children: [
						{ name: 'Open', id: 'open-17', value: 6 },
						{ name: 'In Progress', id: 'in-progress-17', value: 4 },
						{ name: 'Resolved', id: 'resolved-17', value: 20 }
					]
				}
			]
		}
	];
</script>

<div class="bg-white p-6 h-screen">
	<div class="mb-4">
		<h1 class="text-2xl font-bold">Vulnerability Distribution Treemap</h1>
		<p class="text-gray-600 mt-2">
			Hierarchical view: Domains → Severity → Status (with dummy data)
		</p>
	</div>
	<div class="h-[calc(100vh-150px)]">
		<TreemapChart tree={dummyData} name="vulnerability_treemap" title="Click to drill down" />
	</div>
</div>
